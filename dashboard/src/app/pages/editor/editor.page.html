<div class="page">
  <header class="header">
    <div class="left">
      <h1>Content JSON editor</h1>
      <p class="subtitle">Edits <code>/api/content.json</code> and uploads images to <code>/api/uploads</code>.</p>
    </div>
    <div class="actions">
      <a class="link" routerLink="/login">Login</a>
      <button class="btn btn-secondary" type="button" (click)="logout()">Log out</button>
    </div>
  </header>

  <div class="container">
    @if (loading()) {
      <div class="card">Loading…</div>
    } @else {
      <div class="grid">
        <section class="card">
          <h2>JSON</h2>
          <textarea [value]="rawJson()" (input)="onRawJsonInput($event)"></textarea>

          <div class="row">
            <button class="btn" type="button" (click)="format()">Format</button>
            <button class="btn btn-primary" type="button" (click)="save()" [disabled]="saving()">
              {{ saving() ? 'Saving…' : 'Save' }}
            </button>
          </div>

          @if (error()) {
            <div class="alert error">{{ error() }}</div>
          }
          @if (info()) {
            <div class="alert info">{{ info() }}</div>
          }
        </section>

        <section class="card">
          <h2>Image upload</h2>
          <input type="file" accept="image/*" (change)="pickFile($event)" [disabled]="uploading()" />

          @if (uploading()) {
            <p class="muted">Uploading…</p>
          }

          @if (lastUploadUrl()) {
            <div class="alert info">
              URL: <code>{{ lastUploadUrl() }}</code>
            </div>
          }

          <p class="muted">
            Tip: paste the returned URL into the JSON (e.g. <code>cardImage</code> / <code>heroImage</code> / section images).
          </p>

          <button class="btn btn-secondary" type="button" (click)="refresh()">Reload</button>
        </section>
      </div>
    }
  </div>
</div>

